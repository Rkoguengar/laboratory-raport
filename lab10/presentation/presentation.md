---
## Front matter
lang: ru-RU
title: Лабораторная работа №10
subtitle: Основы работы с модулями ядра операционной системы
author:
  - Ришард Когенгар
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 21 января 2026

## Formatting pdf
toc: false
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

# Цель работы

## Основная цель

Получить навыки работы с утилитами управления модулями ядра операционной системы Linux.

# Ход выполнения работы

## Определение устройств и связанных модулей (lspci -k)

- Получение списка PCI-устройств и драйверов
- Анализ строк:
  - **Kernel driver in use**
  - **Kernel modules**
- Примеры обнаруженных связок:
  - сеть: `e1000`
  - видео: `vmwgfx`
  - SATA: `ahci`
  - гостевые модули VirtualBox: `vboxguest`

![Просмотр устройств и связанных модулей командой lspci -k](Screenshot_1.png){ width=80% }

## Просмотр загруженных модулей (lsmod)

- Вывод списка загруженных модулей ядра: `lsmod | sort`
- Поля вывода:
  - имя модуля
  - размер
  - **Used by** (зависимости/использование)
- Наличие аппаратных и системных модулей подтверждает корректную загрузку подсистем

![Просмотр загруженных модулей ядра](Screenshot_2.png){ width=80% }

## Загрузка ext4 и проверка зависимостей

- Загрузка модуля: `modprobe ext4`
- Повторная проверка: `lsmod | grep ext4`
- Обнаружены зависимости:
  - `jbd2` (журналирование)
  - `mbcache` (кэширование метаданных)

![Загрузка ext4 и просмотр информации о модуле](Screenshot_3.png){ width=80% }

## Выгрузка ext4 и попытка выгрузки xfs

- Выгрузка ext4: `modprobe -r ext4`
- Результат: модуль удалён при отсутствии активного использования
- Попытка выгрузки xfs: `modprobe -r xfs`
- Результат: ошибка, так как модуль используется

![Выгрузка ext4 и ошибка при выгрузке xfs](Screenshot_4.png){ width=80% }

## Проверка и загрузка bluetooth

- Проверка наличия: `lsmod | grep bluetooth`
- Загрузка: `modprobe bluetooth`
- Повторная проверка показала:
  - `bluetooth`
  - `rfkill` (зависимость подсистемы)

![Загрузка bluetooth и базовая информация о модуле](Screenshot_5.png){ width=80% }

## Параметры bluetooth и выгрузка

- Просмотр сведений: `modinfo bluetooth`
- Параметры модуля (`parm:`):
  - `disable_esco` (bool)
  - `disable_ertm` (bool)
  - `enable_ecred` (bool)
- Выгрузка модуля: `modprobe -r bluetooth`

![Параметры модуля bluetooth и выгрузка](Screenshot_6.png){ width=80% }

## Проверка версии ядра и пакетов

- Текущая версия ядра: `uname -r`
- Список пакетов ядра: `dnf list kernel`
- Подготовка к обновлению: `dnf upgrade --refresh`

![Проверка версии ядра и попытка обновления через dnf](Screenshot_7.png){ width=80% }

## Обновление и проверка после перезагрузки

- Обновление ядра: `dnf update kernel`
- Перезагрузка системы
- Проверка:
  - `uname -r`
  - `hostnamectl`
- Результат: ядро актуально, версия сохранилась (обновлений не было)

![Проверка версии ядра после перезагрузки и сведения о системе](Screenshot_8.png){ width=80% }

# Итоги работы

## Вывод

- Выполнен анализ устройств и связанных драйверов (lspci)
- Изучены загруженные модули и зависимости (lsmod)
- Отработаны операции загрузки/выгрузки модулей:
  - успешная выгрузка `ext4` при отсутствии использования
  - невозможность выгрузки `xfs` из-за активного использования
- Рассмотрена загрузка модуля с параметрами на примере `bluetooth`
- Выполнена проверка и попытка обновления ядра; подтверждена актуальность установленной версии
