---
## Front matter
title: "Отчёт по лабораторной работе №4"
subtitle: "Работа с программными пакетами"
author: "Ришард Когенгар"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки работы с репозиториями и менеджерами пакетов.

# Ход выполнения

## Работа с репозиториями Rocky Linux (DNF)

1. В консоли выполнен переход в режим суперпользователя.  
   Для получения административных прав использована команда `sudo -i`, после чего работа продолжена от имени пользователя **root**.

   ![Переход в режим суперпользователя](Screenshot_1.png)

2. Выполнен переход в каталог с конфигурационными файлами репозиториев `/etc/yum.repos.d`.  
   В результате просмотра содержимого каталога получен список файлов репозиториев: `rocky-addons.repo`, `rocky-devel.repo`, `rocky-extras.repo`, `rocky.repo`.  
   Далее изучено содержимое файла `rocky-extras.repo`. В конфигурации репозитория указаны его имя, источник зеркал загрузки, параметры проверки GPG-подписи, срок актуальности метаданных и состояние репозитория (включён).

3. Получен список доступных и активных репозиториев системы.  
   В выводе отображены идентификаторы и имена репозиториев **Rocky Linux 10 – BaseOS**, **Rocky Linux 10 – AppStream** и **Rocky Linux 10 – Extras**.  
   Это подтверждает, что система корректно подключена к основным официальным репозиториям Rocky Linux и может использовать их для установки и обновления пакетов.

4. Выполнен поиск пакетов, в названии или описании которых присутствует ключевое слово `user`.  
   В результатах поиска отображены пакеты, у которых совпадение найдено в имени, кратком описании или в обоих полях.  
   Данный механизм позволяет находить необходимые пакеты по смысловому признаку без точного знания их названия.

   ![Поиск пакетов по ключевому слову user](Screenshot_2.png)

5. Перед установкой сетевого сканера `nmap` выполнено изучение доступных пакетов и их описаний.  
   В ходе поиска определены пакеты `nmap` и `nmap-ncat`.  
   Просмотр информации о пакете `nmap` показал его версию, архитектуру, репозиторий размещения, размер, а также назначение — инструмент для сетевого сканирования и аудита безопасности.

   ![Поиск и информация о пакете nmap](Screenshot_3.png)

6. Выполнена установка пакета `nmap`. После этого выполнена установка с использованием шаблона имени пакета.  
   При установке конкретного пакета устанавливается только сам `nmap`.  
   При использовании шаблона `nmap*` система обрабатывает все пакеты, имена которых начинаются с `nmap`, включая дополнительные компоненты, такие как `nmap-ncat`.

   **Разница между способами установки:**  
   - установка по точному имени затрагивает только указанный пакет;  
   - установка по маске может привести к установке нескольких связанных пакетов.

   ![Установка nmap](Screenshot_4.png)

7. Выполнено удаление установленного программного обеспечения.  
   Сначала удалён пакет `nmap`, после чего выполнено удаление всех пакетов, соответствующих шаблону `nmap*`.  
   Это позволило удалить как основной пакет, так и дополнительные компоненты, установленные ранее.

   ![Удаление nmap и связанных пакетов](Screenshot_5.png)

8. Получен список доступных и установленных групп пакетов.  
   В выводе указана установленная среда **Server with GUI**, а также перечень доступных групп, включая **RPM Development Tools**.

   ![Список групп пакетов](Screenshot_6.png)

   Далее изучена информация о группе **RPM Development Tools**, включающей инструменты для сборки RPM-пакетов.  
   После просмотра состава выполнена установка данной группы, в результате чего был установлен пакет `rpmdevtools` и активирована соответствующая группа.

   ![Информация и установка группы RPM Development Tools](Screenshot_7.png)

9. Выполнено удаление группы пакетов **RPM Development Tools**.  
   В ходе операции были удалены пакеты, установленные в составе данной группы, и освобождено дисковое пространство.

   ![Удаление группы RPM Development Tools](Screenshot_8.png)

10. Просмотрена история выполнения операций менеджера пакетов.  
    В истории отображены все транзакции с указанием идентификаторов, времени выполнения и типа операции.  
    Для демонстрации механизма отката выполнена отмена выбранной транзакции, в результате чего ранее удалённая группа пакетов была восстановлена.

    ![История dnf и откат транзакции](Screenshot_9.png)

## Использование rpm (установка lynx из rpm-пакета)

1. Выполнена проверка доступности пакета `lynx` в репозиториях и его загрузка без установки.  
   Командой `dnf list lynx` подтверждено наличие пакета **lynx.x86_64** в репозитории **appstream**.  
   Далее выполнена загрузка пакета командой `dnf install lynx --downloadonly`, при этом `dnf` скачал RPM-файл и сохранил его в локальном кэше, не устанавливая пакет в систему на данном этапе.

   ![Проверка наличия lynx и загрузка RPM без установки](Screenshot_10.png)

2. Определён каталог, в который был помещён скачанный RPM-пакет.  
   Для поиска расположения файла использована команда `find /var/cache/dnf/ -name lynx*`.  
   В результате найден RPM-файл `lynx-2.9.0-6.el10.x86_64.rpm` в подкаталоге кэша `dnf`, относящемся к репозиторию AppStream.

3. Выполнен переход в каталог с загруженным пакетом и произведена установка RPM вручную.  
   После перехода в каталог с файлом пакета выполнена установка командой `rpm -Uhv lynx-<версия>.rpm`.  
   Ключи установки:
   - `-U` — установка или обновление пакета;
   - `-h` — вывод индикатора прогресса;
   - `-v` — подробный режим вывода.  
   Установка завершилась успешно.

   ![Установка lynx из RPM-файла](Screenshot_11.png)

4. Определено расположение исполняемого файла `lynx`.  
   Командой `which lynx` получен путь к бинарному файлу, что подтверждает корректную установку приложения и наличие его в `PATH`.

5. По имени файла определено, какому пакету принадлежит `lynx`, и получена общая информация о пакете.  
   Командой `rpm -qf $(which lynx)` установлено, что найденный исполняемый файл относится к пакету **lynx-2.9.0-6.el10.x86_64**.  
   Далее командой `rpm -qi lynx` получены сведения о пакете: версия, релиз, архитектура, дата установки, поставщик, краткое описание и назначение (текстовый веб-браузер).

   ![Просмотр сведений о пакете lynx](Screenshot_12.png)

6. Получен список файлов, входящих в пакет, и отдельно — список документации.  
   Командой `rpm -ql lynx` выведен полный перечень файлов, устанавливаемых пакетом (бинарные файлы, конфигурации, каталоги документации и др.).  
   Командой `rpm -qd lynx` выведены файлы, относящиеся к документации (README, изменения, сертификаты и прочие материалы).  
   После этого выполнен просмотр справки по программе через `man lynx`, что подтверждает корректную установку и доступность руководства.

   ![Список всех файлов пакета lynx](Screenshot_13.png)  
   ![Список документации пакета lynx](Screenshot_14.png)  
   ![Просмотр man-страницы lynx](Screenshot_15.png)

7. Выведен перечень и месторасположение конфигурационных файлов пакета.  
   Командой `rpm -qc lynx` получен список конфигурационных файлов, относящихся к пакету (например, файлы в каталоге `/etc/`).  
   Наличие конфигурационных файлов подтверждает, что пакет устанавливает отдельные параметры настройки браузера.

8. Проверено наличие скриптов, выполняемых при установке/удалении пакета.  
   Командой `rpm -q --scripts lynx` выведена информация о скриптах пакета (pre/post install, pre/post uninstall и т.п.).  
   Скрипты предназначены для автоматизации действий, которые должны выполняться при установке или удалении, например: обновление кэшей, создание служебных файлов, регистрация компонентов, корректная очистка данных.  
   В представленном выводе скрипты отсутствуют либо не содержат дополнительных действий, что означает установку без вспомогательных сценариев обслуживания.

9. Выполнена проверка работоспособности браузера `lynx` из-под учётной записи пользователя.  
   В отдельном терминале под обычной учётной записью запущен `lynx`; отображение стартовой страницы подтверждает корректность установки и возможность использования приложения без привилегий администратора.

   ![Запуск lynx под пользовательской учётной записью](Screenshot_16.png)

10. Выполнено удаление установленного пакета и проверено состояние каталога.  
    В терминале от имени **root** выполнено удаление пакета командой `rpm -e lynx`.  
    После удаления выполнена проверка содержимого каталога (`ls`), что подтверждает удаление установленного пакета из системы (при этом RPM-файл мог оставаться в каталоге, если он не удалялся вручную).

   ![Удаление lynx и проверка содержимого каталога](Screenshot_17.png)

## Использование rpm (установка и анализ пакета dnsmasq)

1. Выполнена проверка наличия пакета `dnsmasq` в системе и его установка.  
   С помощью просмотра списка пакетов установлено, что пакет **dnsmasq.x86_64** версии **2.90-4.el10** уже установлен из репозитория **AppStream**.  
   Повторная установка подтвердила отсутствие необходимости дополнительных действий, так как зависимости были разрешены ранее.

   ![Проверка наличия и установки dnsmasq](Screenshot_18.png)

   Далее определено расположение исполняемого файла сервиса. В результате установлено, что бинарный файл `dnsmasq` расположен в системном каталоге `/sbin`.

2. По имени исполняемого файла определено, какому пакету он принадлежит, и получена расширенная информация о пакете.  
   Установлено, что файл `/sbin/dnsmasq` относится к пакету **dnsmasq-2.90-4.el10.x86_64**.  
   Дополнительная информация о пакете включает версию, архитектуру, дату установки, лицензию, поставщика и описание.  
   Пакет представляет собой лёгковесный DNS-кэширующий сервер с поддержкой DHCP и TFTP, предназначенный для использования в локальных сетях.

   ![Информация о пакете dnsmasq](Screenshot_19.png)

3. Получен список всех файлов, входящих в состав пакета, а также перечень файлов документации.  
   В полном списке файлов присутствуют исполняемый файл, unit-файл systemd, конфигурационные файлы, каталоги документации и лицензий.  
   Отдельно выведен список документации, включающий руководство пользователя, журнал изменений и HTML-документацию.  
   Для ознакомления с возможностями и параметрами сервиса выполнен просмотр справочной страницы `man dnsmasq`.

   ![Список файлов пакета dnsmasq](Screenshot_20.png)  
   ![Список документации пакета dnsmasq](Screenshot_20.png)  
   ![Просмотр man-страницы dnsmasq](Screenshot_21.png)

4. Получен перечень конфигурационных файлов пакета.  
   В результате определены основные конфигурационные файлы, расположенные в каталоге `/etc`, включая основной файл настроек `dnsmasq.conf`.  
   Эти файлы используются для задания параметров работы DNS-, DHCP- и TFTP-сервисов.

   ![Конфигурационные файлы dnsmasq](Screenshot_22.png)

5. Проанализированы скрипты, выполняемые при установке, обновлении и удалении пакета.  
   В составе пакета присутствуют скрипты предварительной и последующей установки, а также скрипты, выполняемые при удалении и обновлении.  
   Их назначение заключается в:
   - создании системного пользователя и группы `dnsmasq`;
   - регистрации и удалении unit-файла `dnsmasq.service` в systemd;
   - корректной инициализации сервиса при установке и очистке системных настроек при удалении пакета.  
   Использование таких скриптов обеспечивает корректную интеграцию сервиса в систему.

6. Выполнено удаление пакета `dnsmasq`.  
   Пакет был удалён из системы с использованием менеджера `rpm`.  
   После удаления сервис и связанные с ним файлы перестали быть доступны в системе, что завершает выполнение задания.

## Вывод

В ходе лабораторной работы были изучены принципы работы с менеджерами пакетов **dnf** и **rpm** в операционной системе Rocky Linux. Были рассмотрены способы установки программ как из репозиториев, так и из локальных RPM-пакетов, а также методы получения детальной информации о составе и назначении пакетов.

На практике выполнен анализ пакетов `lynx` и `dnsmasq`, определены их исполняемые файлы, конфигурационные файлы, документация и служебные скрипты, используемые при установке и удалении. Кроме того, был изучен механизм автоматической интеграции сервисов в систему с использованием systemd.

Полученные результаты подтверждают, что использование `dnf` упрощает управление зависимостями и установку программного обеспечения, тогда как `rpm` предоставляет более низкоуровневые средства контроля над пакетами и их содержимым.

# Контрольные вопросы

**1. Какая команда позволяет вам искать пакет rpm, содержащий файл useradd?**  
Для определения пакета, которому принадлежит файл `useradd`, используется команда:
`rpm -qf /usr/sbin/useradd`  
Данная команда позволяет по имени файла определить RPM-пакет, в состав которого он входит.

**2. Какие команды нужно использовать, чтобы показать имя группы dnf, которая содержит инструменты безопасности, и посмотреть, что входит в эту группу?**  
Для получения списка групп пакетов используется команда:
`dnf groups list`  
После определения нужной группы (например, **Security Tools**) для просмотра её содержимого применяется команда:
`dnf groups info "Security Tools"`  
В результате отображается описание группы и перечень входящих в неё пакетов.

**3. Какая команда позволяет установить rpm, который был загружен из Интернета и отсутствует в репозиториях?**  
Для установки локального RPM-пакета используется команда:
`rpm -Uhv имя_пакета.rpm`  
Данная команда выполняет установку или обновление пакета из локального файла без обращения к репозиториям.

**4. Какая команда позволяет убедиться, что загруженный rpm-пакет не содержит опасных сценариев?**  
Для просмотра сценариев установки и удаления пакета используется команда:
`rpm -q --scripts имя_пакета`  
Она выводит все pre/post-install и pre/post-uninstall скрипты, что позволяет оценить их содержимое и безопасность.

**5. Какая команда показывает всю документацию в rpm-пакете?**  
Для отображения файлов документации применяется команда:
`rpm -qd имя_пакета`  
Она выводит список файлов, относящихся к документации данного пакета.

**6. Какая команда показывает, какому rpm-пакету принадлежит файл?**  
Для определения принадлежности файла пакету используется команда:
`rpm -qf /путь/к/файлу`  
Команда возвращает имя и версию RPM-пакета, в который входит указанный файл.
