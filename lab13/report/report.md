---
## Front matter
title: "Отчёт по лабораторной работе №13"
subtitle: "Фильтр пакетов"
author: "Ришард Когенгар"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки настройки пакетного фильтра в Linux.

# Ход выполнения

## Управление брандмауэром с помощью firewall-cmd

1. Для выполнения операций управления межсетевым экраном были получены полномочия администратора.  
   Вход в систему выполнен под пользователем **root**, что обеспечило доступ к системным настройкам и службам безопасности.

2. С помощью команды определения зоны по умолчанию установлено, что активной зоной firewalld является **public**.

3. Выполнен просмотр всех доступных зон межсетевого экрана.  
   В результате получен список стандартных зон firewalld, включая block, dmz, drop, external, home, internal, nm-shared, public, trusted и work.

4. Получен список всех служб, поддерживаемых межсетевым экраном.  
   В выводе представлены сетевые и серверные службы, доступные для использования в конфигурации firewalld.

   ![Список доступных служб firewalld](Screenshot_1.png)

5. Определены службы, разрешённые в текущей активной зоне.  
   Установлено, что в зоне **public** разрешены службы **cockpit**, **dhcpv6-client** и **ssh**.

6. Выполнено сравнение конфигурации текущей зоны и явного указания зоны **public**.  
   Результаты полностью совпали, что подтверждает использование зоны **public** в качестве зоны по умолчанию и её активное состояние.

   ![Просмотр конфигурации текущей зоны](Screenshot_2.png)  
   
   ![Просмотр конфигурации зоны public](Screenshot_3.png)

7. В конфигурацию времени выполнения межсетевого экрана добавлена служба **vnc-server**.  
   Изменение применено успешно и вступило в силу немедленно.

   ![Добавление службы vnc-server](Screenshot_4.png)

8. Проверка текущей конфигурации показала наличие службы **vnc-server** в списке разрешённых сервисов активной зоны.

9. Выполнен перезапуск службы firewalld для проверки сохранности временных изменений.

10. После перезапуска службы установлено, что **vnc-server** отсутствует в конфигурации.  
    Это связано с тем, что служба была добавлена только в конфигурацию времени выполнения и не была сохранена на постоянной основе. При перезапуске firewalld временные правила были сброшены.

    ![Отсутствие vnc-server после перезапуска firewalld](Screenshot_5.png)

11. Служба **vnc-server** добавлена в постоянную конфигурацию межсетевого экрана.  
    Изменение сохранено в конфигурационных файлах firewalld.

12. При проверке конфигурации времени выполнения служба **vnc-server** не отображается.  
    Это объясняется тем, что постоянная конфигурация автоматически не применяется без перезагрузки правил.

    ![Отсутствие vnc-server без перезагрузки конфигурации](Screenshot_6.png)

13. Выполнена перезагрузка конфигурации firewalld.  
    После применения постоянных правил служба **vnc-server** отобразилась в списке разрешённых сервисов активной зоны.

    ![Применение постоянной конфигурации firewalld](Screenshot_7.png)

14. В постоянную конфигурацию межсетевого экрана добавлен TCP-порт **2022**.  
    После этого выполнена перезагрузка конфигурации firewalld для применения изменений.

15. Проверка конфигурации подтвердила, что порт **2022/tcp** успешно добавлен и разрешён в активной зоне.

    ![Проверка добавленного порта 2022](Screenshot_8.png)

## Управление брандмауэром с помощью firewall-config

1. В графической среде операционной системы открыт терминал, после чего под учётной записью пользователя запущена утилита графического управления межсетевым экраном **firewall-config**.  
   При запуске утилиты выполнена аутентификация пользователя с административными полномочиями, что позволило получить доступ к настройке службы firewalld.

2. В верхней части окна утилиты в параметре **Configuration** из выпадающего списка выбрано значение **Permanent**.  
   Это обеспечило сохранение всех вносимых изменений в постоянной конфигурации межсетевого экрана, которая применяется после перезагрузки службы или системы.

3. В списке зон выбрана зона **public**, используемая в системе по умолчанию.  
   На вкладке **Services** отмечены службы **http**, **https** и **ftp**, что разрешило входящие соединения для соответствующих сетевых сервисов в данной зоне.

   ![Включение служб http, https и ftp](Screenshot_9.png)

4. На вкладке **Ports** нажата кнопка **Add**, после чего в открывшемся диалоговом окне указан порт **2022** и выбран протокол **udp**.  
   После подтверждения порт был добавлен в список разрешённых портов зоны **public**.

   ![Добавление UDP-порта 2022](Screenshot_10.png)

5. После завершения настройки графическая утилита **firewall-config** была закрыта. Все изменения были сохранены в постоянной конфигурации межсетевого экрана.

6. В терминале выполнен просмотр текущей конфигурации зоны с помощью команды просмотра параметров firewalld.  
   В выводе установлено, что изменения, выполненные через графический интерфейс, ещё не применены к конфигурации времени выполнения, так как они были сохранены только в постоянной конфигурации.

   ![Просмотр конфигурации до перезагрузки](Screenshot_11.png)

7. Для применения постоянной конфигурации выполнена перезагрузка правил межсетевого экрана.  
   После этого повторный просмотр конфигурации показал, что службы **http**, **https**, **ftp**, а также порт **2022/udp** успешно применены и активны.

   ![Применение изменений после reload](Screenshot_12.png)

## Самостоятельная работа

1. Создана конфигурация межсетевого экрана, разрешающая доступ к службам **telnet**, **imap**, **pop3** и **smtp**.

2. Служба **telnet** была добавлена в постоянную конфигурацию с использованием интерфейса командной строки.  
   После перезагрузки конфигурации firewalld служба стала доступна в активной зоне.

3. Службы **imap**, **pop3** и **smtp** были добавлены через графический интерфейс **firewall-config** в зоне **public**.  
   Все изменения выполнены в режиме **Permanent**, что гарантирует их сохранение после перезагрузки системы.

   ![Добавление служб imap, pop3 и smtp через GUI](Screenshot_13.png)

4. После перезагрузки конфигурации межсетевого экрана выполнена проверка параметров.  
   Установлено, что все добавленные службы и порты присутствуют в конфигурации и будут автоматически активированы после перезагрузки компьютера.

   ![Итоговая конфигурация firewalld](Screenshot_14.png)

## Вывод

В ходе работы были изучены и практически применены способы управления межсетевым экраном firewalld с использованием как командной строки (`firewall-cmd`), так и графического интерфейса (`firewall-config`). Были освоены принципы работы конфигураций времени выполнения и постоянных конфигураций, а также порядок их применения. В результате настроена постоянная конфигурация брандмауэра, обеспечивающая доступ к необходимым сетевым службам и портам и сохраняющаяся после перезагрузки системы.

# Контрольные вопросы

**1. Какая служба должна быть запущена перед началом работы с менеджером конфигурации брандмауэра firewall-config?**  

Перед началом работы с утилитой **firewall-config** должна быть запущена служба **firewalld**, так как именно она отвечает за управление межсетевым экраном и хранение его конфигурации.

**2. Какая команда позволяет добавить UDP-порт 2355 в конфигурацию брандмауэра в зоне по умолчанию?**  

Для добавления UDP-порта 2355 в зону по умолчанию используется команда:  
`firewall-cmd --add-port=2355/udp`  

Для добавления порта на постоянной основе:  
`firewall-cmd --add-port=2355/udp --permanent`

**3. Какая команда позволяет показать всю конфигурацию брандмауэра во всех зонах?**  

Для отображения полной конфигурации межсетевого экрана по всем зонам используется команда:  
`firewall-cmd --list-all-zones`

**4. Какая команда позволяет удалить службу vnc-server из текущей конфигурации брандмауэра?**  

Для удаления службы **vnc-server** из конфигурации времени выполнения применяется команда:  
`firewall-cmd --remove-service=vnc-server`  

Для удаления службы из постоянной конфигурации:  
`firewall-cmd --remove-service=vnc-server --permanent`

**5. Какая команда firewall-cmd позволяет активировать новую конфигурацию, добавленную опцией --permanent?**  

Для применения постоянной конфигурации к текущему состоянию используется команда:  
`firewall-cmd --reload`

**6. Какой параметр firewall-cmd позволяет проверить, что новая конфигурация была добавлена в текущую зону и теперь активна?**  

Для проверки активной конфигурации текущей зоны применяется команда:  
`firewall-cmd --list-all`  

Она отображает список разрешённых служб, портов и других параметров активной зоны.

**7. Какая команда позволяет добавить интерфейс eno1 в зону public?**  

Для привязки сетевого интерфейса **eno1** к зоне **public** используется команда:  
`firewall-cmd --zone=public --add-interface=eno1`  

Для сохранения изменения на постоянной основе:  
`firewall-cmd --zone=public --add-interface=eno1 --permanent`

**8. Если добавить новый интерфейс в конфигурацию брандмауэра, пока не указана зона, в какую зону он будет добавлен?**  

Если при добавлении сетевого интерфейса зона не указана явно, интерфейс будет автоматически добавлен в **зону по умолчанию**, которая определяется параметром default zone (в большинстве систем — зона **public**).
