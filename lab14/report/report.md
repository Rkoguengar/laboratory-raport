---
## Front matter
title: "Отчёт по лабораторной работе №14"
subtitle: "Партиции, файловые системы, монтирование"
author: "Ришард Когенгар"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки создания разделов на диске и файловых систем. Получить навыки монтирования файловых систем.

# Ход выполнения

## Создание виртуальных носителей и разметка дисков с использованием fdisk

1. В настройках виртуальной машины в среде виртуализации **Oracle VirtualBox** выполнено добавление двух дополнительных виртуальных жёстких дисков.  
   В разделе **Настроить → Носители** на контроллере **SATA** последовательно созданы два новых диска формата **VDI** с динамическим выделением памяти.  
   Каждый диск имеет объём **512 МБ** и сохранён в каталоге виртуальной машины под именами **rishardkogengar_1.vdi** и **rishardkogengar_2.vdi**.

   ![Добавленные виртуальные носители](Screenshot_1.png)

2. После добавления виртуальных носителей виртуальная машина была запущена.  
   В системе под учётной записью администратора выполнена проверка подключённых устройств хранения данных с помощью утилиты **fdisk**.  
   В выводе списка дисков зафиксировано наличие основного диска **/dev/sda** объёмом **40 ГБ**, а также двух дополнительных дисков **/dev/sdb** и **/dev/sdc**, соответствующих добавленным виртуальным носителям.

   ![Список доступных дисков](Screenshot_2.png)

3. Для выполнения разметки выбран диск **/dev/sdb**.  
   Запущена утилита **fdisk**, при этом утилита сообщила об отсутствии таблицы разделов и создала новую таблицу типа **DOS (MBR)**.

   ![Запуск fdisk и создание MBR](Screenshot_3.png)

4. С использованием команды просмотра таблицы разделов выполнена проверка текущего состояния диска.  
   На данном этапе разделы отсутствовали, свободное пространство было доступно для создания новых разделов.

5. Выполнено создание первичного раздела.  
   В качестве типа выбран **primary**, принят номер раздела **1**, первый сектор оставлен по умолчанию.  
   Для ограничения размера задан параметр **+300M**, в результате чего создан раздел объёмом **300 МБ**.  
   Тип раздела установлен как **83 (Linux)**. После завершения параметры записаны на диск.

   ![Создание первичного раздела](Screenshot_4.png)

6. После записи изменений выполнена проверка структуры разделов диска **/dev/sdb**.  
   В выводе утилиты зафиксирован созданный раздел **/dev/sdb1**.

7. Далее выполнено сравнение вывода списка разделов диска и содержимого файла **/proc/partitions**.  
   Разница заключается в том, что **fdisk** читает таблицу разделов непосредственно с диска, а **/proc/partitions** отображает состояние, известное ядру.  
   До обновления таблицы разделов ядро может не отражать изменения, выполненные на диске.

8. Для синхронизации таблицы разделов диска с таблицей разделов в ядре выполнено обновление средствами **partprobe**.

   ![Обновление таблицы разделов ядра](Screenshot_5.png)

9. После обновления повторно выполнена проверка **/proc/partitions**, в результате чего новый раздел **/dev/sdb1** был корректно отображён, что подтверждает успешную синхронизацию.

## Создание логических разделов

10. Для продолжения разметки диска **/dev/sdb** повторно запущена утилита **fdisk**.  
    Создан расширенный раздел типа **extended**, которому присвоен номер **4**.  
    Начальный сектор принят по умолчанию, конечный сектор также принят по умолчанию, что позволило занять всё оставшееся свободное пространство диска.

   ![Создание расширенного раздела](Screenshot_6.png)

11. После создания расширенного раздела выполнено создание логического раздела.  
    Так как свободные первичные разделы отсутствовали, утилита предложила создать логический раздел с номером **5**.  
    Для логического раздела задан размер **+300M**, тип оставлен по умолчанию **83 (Linux)**. Изменения записаны на диск.

12. Для завершения процедуры и обновления таблицы разделов ядра повторно выполнено обновление средствами **partprobe**.

13. Выполнена итоговая проверка созданных разделов.  
    В результате отображены:
    - первичный раздел **/dev/sdb1**;
    - расширенный раздел **/dev/sdb4**;
    - логический раздел **/dev/sdb5**.  
    Это подтверждает корректное выполнение разметки диска.

   ![Итоговая таблица разделов](Screenshot_7.png)

## Создание раздела подкачки

1. Для создания раздела подкачки на диске **/dev/sdb** получены полномочия администратора и запущена утилита разметки дисков **fdisk**.  
   При попытке создания нового раздела утилита сообщила об отсутствии свободных первичных разделов и автоматически предложила создать логический раздел с номером **6**.

   ![Создание логического раздела под swap](Screenshot_8.png)

2. В качестве начального сектора принят сектор по умолчанию.  
   Для задания размера раздела указано значение **+300M**, в результате чего был создан логический раздел объёмом **300 МБ**.

3. После создания раздела выполнено изменение его типа.  
   С помощью команды изменения типа раздела выбран номер **6**, после чего указан код типа **82**, соответствующий разделу подкачки (**Linux swap / Solaris**).  
   Изменения записаны на диск с подтверждением сохранения таблицы разделов.

4. Для обновления информации о разделах в ядре операционной системы выполнена синхронизация таблицы разделов диска.

   ![Обновление таблицы разделов после создания swap](Screenshot_9.png)

5. После обновления выполнен просмотр списка разделов.  
   В выводе зафиксировано наличие логического раздела **/dev/sdb6** с типом **Linux swap**, что подтверждает корректность его создания.

   ![Проверка разделов после создания swap](Screenshot_10.png)

6. Созданный раздел подкачки был отформатирован.  
   В процессе форматирования раздел инициализирован как пространство подкачки, после чего ему был присвоен уникальный идентификатор.

7. Для активации нового пространства подкачки раздел **/dev/sdb6** был включён в систему.  
   После активации выполнена проверка объёма доступной оперативной памяти и пространства подкачки.

   ![Проверка использования swap](Screenshot_11.png)

8. По результатам проверки подтверждено, что новое пространство подкачки успешно подключено и доступно для использования операционной системой.

## Создание разделов GPT с использованием gdisk

9. Для выполнения разметки второго дополнительного диска **/dev/sdc** использована утилита **gdisk**.  
   При просмотре таблицы разделов было установлено, что таблица разделов отсутствует, в результате чего утилита автоматически подготовила создание новой таблицы разделов типа **GPT**.

   ![Просмотр таблицы разделов GPT](Screenshot_12.png)

10. После запуска утилиты **gdisk** выполнено создание нового раздела.  
    В качестве номера раздела принят номер по умолчанию **1**.  
    Начальный сектор выбран автоматически, для задания размера раздела указано значение **+300M**, что позволило создать раздел объёмом **300 МБ**.

11. Тип создаваемого раздела оставлен по умолчанию — **8300 (Linux filesystem)**.  
    После создания раздела выполнен просмотр текущей структуры диска, которая отразила наличие одного раздела в таблице GPT.

12. После подтверждения корректности разметки изменения были записаны на диск.  
    Для завершения процедуры выполнено обновление таблицы разделов ядра операционной системы.

13. В завершение выполнена проверка информации о разделах.  
    В выводе зафиксировано наличие диска **/dev/sdc** с корректной таблицей разделов **GPT** и созданным разделом **/dev/sdc1**, что подтверждает успешное выполнение разметки.

   ![Итоговая проверка GPT-разделов](Screenshot_13.png)

## Форматирование файловой системы XFS

1. Для первичного раздела **/dev/sdb1** выполнено создание файловой системы типа **XFS**.  
   В ходе форматирования были автоматически заданы параметры структуры файловой системы, включая размер блока, параметры журналирования и метаданных.

   ![Форматирование раздела XFS](Screenshot_14.png)

2. После создания файловой системы для раздела **/dev/sdb1** установлена метка тома **xfsdisk**, что упрощает идентификацию раздела при дальнейшей работе.

## Форматирование файловой системы EXT4

1. Для логического раздела **/dev/sdb5** выполнено создание файловой системы типа **EXT4**.  
   В процессе форматирования была создана таблица inode, журнал файловой системы и резервные копии суперблоков.

   ![Форматирование раздела EXT4](Screenshot_15.png)

2. После форматирования для файловой системы EXT4 установлена метка тома **ext4disk**.

3. Дополнительно для файловой системы EXT4 включены параметры монтирования по умолчанию, обеспечивающие поддержку списков контроля доступа (**ACL**) и расширенных атрибутов пользователя (**user_xattr**).  
   Данные параметры повышают гибкость управления доступом к объектам файловой системы.

## Ручное монтирование файловых систем

1. Для проверки корректности работы файловой системы EXT4 создана точка монтирования **/mnt/tmp**.

2. Раздел **/dev/sdb5** был вручную смонтирован в созданную точку монтирования.  
   После монтирования выполнена проверка, которая подтвердила, что раздел успешно подключён и доступен для использования.

   ![Проверка ручного монтирования](Screenshot_16.png)

3. После завершения проверки раздел **/dev/sdb5** был корректно отмонтирован.  
   Повторная проверка показала отсутствие раздела в списке смонтированных файловых систем.

## Монтирование разделов с использованием /etc/fstab

1. Для организации постоянного монтирования раздела **/dev/sdb1** создана точка монтирования **/mnt/data**.

2. Выполнен просмотр идентификаторов блочных устройств.  
    Для раздела **/dev/sdb1** определён его уникальный идентификатор **UUID**, а также подтверждён тип файловой системы **XFS** и установленная метка тома.

    ![Просмотр UUID разделов](Screenshot_17.png)

3. Файл **/etc/fstab** был отредактирован с добавлением записи для автоматического монтирования раздела **/dev/sdb1** в каталог **/mnt/data** при загрузке системы.  
    В записи использован UUID устройства, файловая система **xfs** и стандартные параметры монтирования.

    ![Редактирование файла fstab](Screenshot_18.png)

4. Для проверки корректности конфигурации выполнено монтирование всех файловых систем, указанных в **/etc/fstab**.  
    Несмотря на предупреждение о необходимости перезагрузки демона systemd, раздел был успешно смонтирован.

5. Итоговая проверка показала, что раздел **/dev/sdb1** корректно смонтирован в каталог **/mnt/data**, доступен для работы и отображается в списке файловых систем с указанием объёма и свободного пространства.

   ![Итоговая проверка монтирования](Screenshot_19.png)

## Самостоятельная работа

1. Для выполнения самостоятельной работы использован диск **/dev/sdc** с таблицей разделов **GPT**.  
   В утилите **gdisk** выполнен просмотр текущей структуры диска, после чего созданы дополнительные разделы.

   ![Просмотр структуры GPT-диска](Screenshot_20.png)

2. На диске **/dev/sdc** созданы два новых раздела размером по **300 МБ** каждый:  
   - раздел **/dev/sdc2** с типом **Linux filesystem (8300)**;  
   - раздел **/dev/sdc3** с типом **Linux swap (8200)**.  

   После проверки корректности структуры таблицы разделов изменения были записаны на диск и выполнено обновление таблицы разделов ядра.

3. Для раздела **/dev/sdc2** создана файловая система **EXT4**.  
   После форматирования для файловой системы установлена метка тома **ext4disk2**, а также включены параметры поддержки списков контроля доступа и расширенных атрибутов пользователя.

   ![Форматирование EXT4 на GPT-диске](Screenshot_21.png)

4. Раздел **/dev/sdc3** был инициализирован как пространство подкачки.  
   В процессе инициализации разделу был присвоен уникальный идентификатор **UUID**, что позволяет использовать его для постоянного подключения в системе.

   ![Создание swap-раздела на GPT-диске](Screenshot_22.png)

5. Для настройки автоматического монтирования выполнен просмотр идентификаторов всех блочных устройств.  
   Для разделов **/dev/sdc2** и **/dev/sdc3** были определены их UUID и типы файловых систем.

6. В файле **/etc/fstab** добавлены записи:  
   - для автоматического монтирования раздела **EXT4** в каталог **/mnt/data-ext**;  
   - для автоматического подключения раздела подкачки **swap**.  

   Использование UUID обеспечивает корректное монтирование независимо от порядка обнаружения устройств при загрузке системы.

   ![Редактирование файла fstab](Screenshot_23.png)

7. После внесения изменений выполнена проверка конфигурации автоматического монтирования.  
   Раздел **/dev/sdc2** был успешно примонтирован в каталог **/mnt/data-ext**, а пространство подкачки подключено и доступно системе.

8. В ходе итоговой проверки подтверждено:
   - корректное монтирование файловой системы **EXT4** в каталог **/mnt/data-ext**;
   - наличие подключённого пространства подкачки;
   - отсутствие ошибок в конфигурации **/etc/fstab**.

   ![Итоговая проверка монтирования и swap](Screenshot_24.png)

9. После перезагрузки системы повторно выполнена проверка состояния файловых систем и пространства подкачки.  
   Результаты подтвердили, что все разделы автоматически монтируются и корректно функционируют, что свидетельствует об успешном выполнении самостоятельной работы.

## Вывод

В ходе лабораторной работы были получены практические навыки управления дисковым пространством в операционной системе Linux. Выполнено создание и подключение дополнительных виртуальных носителей, разметка дисков с использованием таблиц разделов MBR и GPT, а также создание первичных, расширенных и логических разделов.

Были освоены операции форматирования файловых систем **XFS** и **EXT4**, настройка и использование пространства подкачки, а также ручное и автоматическое монтирование разделов с применением файла **/etc/fstab**. Проведена проверка корректности работы файловых систем и параметров монтирования до и после перезагрузки системы.

# Контрольные вопросы

**1. Какой инструмент используется для создания разделов GUID?**  

Для создания и управления разделами с таблицей **GUID Partition Table (GPT)** используется утилита  
`gdisk`.  

Пример применения:  
`gdisk /dev/sdc`

**2. Какой инструмент применяется для создания разделов MBR?**  

Для работы с таблицей разделов **MBR (DOS)** используется утилита  
`fdisk`.  

Пример применения:  
`fdisk /dev/sdb`

**3. Какой файл используется для автоматического монтирования разделов во время загрузки?**  

Для автоматического монтирования файловых систем при загрузке системы используется файл  
`/etc/fstab`.

В данном файле задаются точки монтирования, типы файловых систем и параметры монтирования.

**4. Какой вариант монтирования целесообразно выбрать, если необходимо, чтобы файловая система не была автоматически примонтирована во время загрузки?**  

Если требуется исключить автоматическое монтирование файловой системы при загрузке, раздел **не следует добавлять** в файл `/etc/fstab`.  

В этом случае используется **ручное монтирование** с помощью команды `mount`.

**5. Какая команда позволяет форматировать раздел с типом 82 с соответствующей файловой системой?**  

Раздел с типом **82 (Linux swap)** форматируется с использованием утилиты  
`mkswap`.

Пример:  
`mkswap /dev/sdb6`

**6. Вы только что добавили несколько разделов для автоматического монтирования при загрузке. Как можно безопасно проверить, будет ли это работать без реальной перезагрузки?**  

Для проверки корректности записей в файле `/etc/fstab` без перезагрузки системы используется команда:  
`mount -a`  

Она выполняет монтирование всех файловых систем, указанных в `/etc/fstab`, и позволяет выявить ошибки конфигурации.

**7. Какая файловая система создаётся, если вы используете команду mkfs без какой-либо спецификации файловой системы?**  

Если команда `mkfs` используется без указания типа файловой системы, по умолчанию создаётся файловая система **EXT2** (либо системный вариант по умолчанию, определённый в дистрибутиве).

**8. Как форматировать раздел EXT4?**  

Для создания файловой системы **EXT4** используется команда  
`mkfs.ext4`.

Пример:  
`mkfs.ext4 /dev/sdb5`

**9. Как найти UUID для всех устройств на компьютере?**  

Для просмотра UUID, типа файловой системы и меток всех блочных устройств используется утилита  
`blkid`.

Пример:  
`blkid`
