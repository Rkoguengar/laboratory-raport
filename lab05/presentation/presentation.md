---
## Front matter
lang: ru-RU
title: Лабораторная работа №5
subtitle: Управление системными службами (systemd)
author:
  - Ришард Когенгар
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 19 января 2026

## Formatting pdf
toc: false
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

# Цель работы

## Основная цель

Получить навыки управления системными службами операционной системы посредством systemd.

# Ход выполнения работы

## Управление системными службами (vsftpd)

- Получены полномочия администратора
- Проверен статус службы Very Secure FTP (vsftpd)
- Выполнена установка пакета vsftpd
- Служба запущена и проверена её работоспособность

![Запуск vsftpd и проверка статуса](Screenshot_1.png){ width=80% }

## Автозапуск службы (enable/disable)

- Включение автозапуска службы при загрузке ОС (состояние enabled)
- Отключение автозапуска службы (состояние disabled)
- Подтверждение изменений через проверку статуса юнита

![Включение автозапуска vsftpd](Screenshot_2.png){ width=80% }

## Автозапуск и зависимости vsftpd

- Проверка наличия символической ссылки в multi-user.target.wants
- Повторное добавление службы в автозапуск и подтверждение создания ссылки
- Анализ зависимостей юнита и обратных зависимостей (reverse)

![Проверка символических ссылок и повторное включение автозапуска](Screenshot_4.png){ width=80% }

## Установка iptables и проверка статусов

- Установлены пакеты iptables и компоненты подсистемы
- Проверено состояние служб firewalld и iptables
- Зафиксировано, что firewalld активен, а iptables не запущен

![Установка пакетов iptables](Screenshot_7.png){ width=80% }

## Демонстрация конфликта firewalld и iptables

- Выполнена попытка запуска firewalld и iptables
- Зафиксирована невозможность их одновременной работы
- Конфликт подтверждён состояниями служб при запуске

![Статус firewalld и iptables](Screenshot_8.png){ width=80% }

## Анализ конфликтов в файле юнита firewalld

- Просмотр конфигурации firewalld.service
- Обнаружена директива Conflicts
- Conflicts запрещает совместную работу с iptables/ip6tables/ebtables/ipset

![Содержимое firewalld.service](Screenshot_9.png){ width=80% }

## Анализ файла юнита iptables

- Просмотр iptables.service
- Тип сервиса oneshot (инициализация правил)
- Сервис предназначен для настройки IPv4-фильтрации и не ориентирован на параллельную работу с firewalld

![Содержимое iptables.service](Screenshot_10.png){ width=80% }

## Маскирование iptables (mask)

- Остановлена служба iptables и запущен firewalld
- Выполнено mask для iptables (создание ссылки на /dev/null)
- Попытка запуска и включения в автозапуск завершилась ошибкой из-за masked

![Маскирование службы iptables и ошибка запуска](Screenshot_11.png){ width=80% }

## Поиск изолируемых целей (AllowIsolate)

- Переход в каталог /usr/lib/systemd/system
- Поиск целей с признаком AllowIsolate=yes
- Получен перечень целей, которые можно изолировать (switch state)

![Список изолируемых целей](Screenshot_12.png){ width=80% }

## Переход в режим восстановления (rescue.target)

- Выполнена изоляция rescue.target
- Система перешла в минимальный режим обслуживания
- Выполнен вход под root для дальнейших действий

![Переход в rescue.target](Screenshot_13.png){ width=80% }

## Проверка текущей цели

- Определена цель загрузки по умолчанию
- Зафиксировано текущее значение default target

![Определение цели по умолчанию](Screenshot_14.png){ width=80% }

## Смена цели по умолчанию

- Установлена цель multi-user.target (текстовый режим)
- После перезагрузки подтверждён запуск в консольном режиме
- Выполнен возврат к graphical.target (графический режим)

![Возврат к graphical.target](Screenshot_15.png){ width=80% }

# Итоги работы

## Вывод

- Освоено управление службами systemd: запуск/остановка, enable/disable, анализ статуса
- Получены навыки анализа зависимостей юнитов и структуры автозапуска через wants-ссылки
- Продемонстрировано разрешение конфликтов сервисов (iptables и firewalld) и применение mask
- Рассмотрены изолируемые цели и настройка цели загрузки по умолчанию
